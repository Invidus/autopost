# Telegram Autoposting Bot

Бот для автоматического копирования сообщений из других Telegram каналов в ваш канал. Бот создает новые сообщения, копируя медиа (фото, видео, документы) и текст, вместо простой пересылки.

## Установка

1. Установите Node.js (версия 18 или выше)

2. Установите зависимости:
```bash
npm install
```

3. Скопируйте `env.example` в `.env`:
```bash
cp env.example .env
```

4. Заполните `.env` файл:
   - Получите `API_ID` и `API_HASH` на https://my.telegram.org
   - Укажите ID вашего канала для постинга
   - Укажите каналы-источники (через запятую)

## Получение API credentials

1. Перейдите на https://my.telegram.org
2. Войдите с вашим номером телефона
3. Перейдите в "API development tools"
4. Создайте приложение и получите `api_id` и `api_hash`

## Получение ID канала

1. Добавьте бота @userinfobot в ваш канал
2. Отправьте любое сообщение в канал
3. Бот пришлет ID канала (формат: -1001234567890)

Или используйте @getidsbot для получения ID.

## Запуск

```bash
npm start
```

При первом запуске потребуется:
- Ввести номер телефона
- Ввести код подтверждения из Telegram
- Ввести пароль (если установлен 2FA)

Сессия сохранится в файл `session.txt`, повторная авторизация не потребуется.

## Настройки

- `POST_DELAY` - задержка между постами в секундах
- `KEYWORDS_FILTER` - поститься будут только сообщения с этими словами
- `EXCLUDE_WORDS` - сообщения с этими словами не будут поститься

## Особенности

- **Создает новые сообщения** вместо пересылки - бот копирует медиа и текст, создавая независимые сообщения
- **Поддерживает все типы медиа**: фото, видео, документы, аудио, голосовые сообщения, стикеры
- **Сохранение текста** - подписи к медиа копируются вместе с файлами
- **Фильтрация** - можно настроить фильтры по ключевым словам

## Важно

- Бот должен быть администратором целевого канала
- Для чтения приватных каналов-источников бот должен быть их администратором
- Публичные каналы можно указывать через @username

## Примеры использования

### Базовый пример
```env
API_ID=12345678
API_HASH=abcdef1234567890abcdef1234567890
TARGET_CHANNEL_ID=-1001234567890
SOURCE_CHANNELS=@meme_channel,@funny_memes
POST_DELAY=60
```

### С фильтрацией по ключевым словам
```env
KEYWORDS_FILTER=мем,юмор,смешно
EXCLUDE_WORDS=реклама,спам
```

## Устранение неполадок

**Ошибка "Файл .env не найден"**
- Убедитесь, что вы скопировали `env.example` в `.env` и заполнили все поля

**Ошибка доступа к каналу**
- Убедитесь, что ваш аккаунт добавлен как администратор в целевой канал
- Проверьте правильность ID канала

**Сообщения не пересылаются**
- Проверьте, что каналы-источники указаны правильно
- Для приватных каналов ваш аккаунт должен быть администратором
- Проверьте фильтры ключевых слов

## Развертывание на VPS

Подробная инструкция по развертыванию на VPS находится в файле [DEPLOYMENT.md](./DEPLOYMENT.md)

### Быстрый старт:

1. **Установка через скрипт:**
```bash
bash install.sh
```

2. **Или вручную через PM2:**
```bash
npm install
npm install -g pm2
pm2 start ecosystem.config.cjs
pm2 save
pm2 startup
```

### Защита от конфликтов с другими ботами

✅ **Конфликтов не будет**, если:
- Каждый бот находится в отдельной директории
- Используются разные имена в PM2: `pm2 start index.js --name bot1`
- Используются разные systemd сервисы: `bot1.service`, `bot2.service`
- Каждый бот имеет свой `.env` и `session.txt` файл

Боты не используют сетевые порты и работают изолированно друг от друга.

### Варианты развертывания:

- **PM2** (рекомендуется) - см. `ecosystem.config.cjs`
- **Systemd** - см. `autoposting-bot.service`
- **Docker** - см. `Dockerfile` и `docker-compose.yml`

